## Problem A: Stochastic simulation by the probability integral transform and bivariate techniques


### 1. Sampling from the exponential distribution

We want to generate $n$ samples the exponential distribution with rate parameter $\lambda$.

```{r}
library(tidyverse)
```

```{r}
rexp <- function(n, rate = 1) {
  uniformly_distributed <- runif(n=n)
  exponentially_distributed <- -log(uniformly_distributed) / rate
  return(enframe(exponentially_distributed))
}
```

```{r}
samples <- 10000
rate <- 1
exponential_samples <- rexp(n = samples, rate = rate)
ggplot() + 
  geom_histogram(
    data = exponential_samples,
    mapping = aes(x=value, y=..density..),
    binwidth = 0.1
  ) +
  geom_vline(
    aes(xintercept = mean(exponential_samples$value))
  ) +
  stat_function(
    fun = dexp,
    args=list(rate = rate),
    aes(col='Theoretical density')
  )
```


### 2. Probability density function

We now consider the probability density function
$$
g(x) =
\begin{cases}
  cx^{\alpha - 1}, & 0 < x < 1, \\
  ce^{-x}, & 1 \leq x, \\
  0, & \text{otherwise,}
\end{cases}
$$
where $c$ is the normalising constant and $\alpha \in (0, 1)$.
First we determine the normalising constant by integration,

$$
1
= \int_\mathbb{R} g(x) \text{d}x
= \int_0^1 cx^{\alpha - 1} \text{d}x + \int_1^\infty ce^{-x} \text{d}x
= c \frac{\alpha + e}{e\alpha} \\
\implies c = \frac{e\alpha}{\alpha + e}
$$


### 3. Box-Muller algorithm for standard normal distribution

(Answer)


### 4. Arbitrary normal distribution

(Answer)
